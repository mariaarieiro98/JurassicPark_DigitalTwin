{"ast":null,"code":"var _jsxFileName = \"/home/maria/Desktop/Marketplace-JurassicPark/backend/web/src/components/FunctionBlocks/FunctionBlock/Event.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { useFunctionBlockStyles } from \"./style\";\nimport { Grid, TextField, Button } from \"@material-ui/core\";\nimport { SearchableList } from '../../templates/Search/SearchableList';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const EventList = /*#__PURE__*/React.memo(_c = _s(props => {\n  _s();\n\n  const classes = useFunctionBlockStyles();\n  const getNonUsedVariables = useCallback(event => {\n    return props.variables.filter(variable => event.eventVariables.find(element => element.evVariableName === variable.variableName) === undefined).map(variable => ({\n      evEventName: event.eventName,\n      evVariableName: variable.variableName\n    }));\n  }, [props.variables]);\n  const updateVars = useCallback((event, eventVariables) => {\n    event.eventVariables = [...eventVariables];\n  }, []);\n  return /*#__PURE__*/_jsxDEV(Grid, {\n    container: true,\n    direction: \"column\",\n    children: [/*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      children: props.title\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      className: classes.box,\n      children: [props.events.map((event, index) => /*#__PURE__*/_jsxDEV(EventRow, {\n        updateVars: updateVars,\n        index: index,\n        addRemoveEvent: props.removeEvent,\n        nonUsedVariables: getNonUsedVariables,\n        setEvent: props.setEvent,\n        event: event,\n        newEvent: false\n      }, index, false, {\n        fileName: _jsxFileName,\n        lineNumber: 46,\n        columnNumber: 58\n      }, this)), /*#__PURE__*/_jsxDEV(EventRow, {\n        addRemoveEvent: props.addNewEvent,\n        setEvent: props.setNewEvent,\n        updateVars: updateVars,\n        nonUsedVariables: getNonUsedVariables,\n        event: props.newEvent,\n        newEvent: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 47,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 43,\n    columnNumber: 5\n  }, this);\n}, \"f3bMV6sMNuSda8svojqoHvQ8HBU=\", false, function () {\n  return [useFunctionBlockStyles];\n}) //,\n// (prevProps: EventProps, nextProps:EventProps) => prevProps.events === nextProps.events && prevProps.variables === nextProps.variables && prevProps.newEvent === nextProps.newEvent\n);\n_c2 = EventList;\nconst eventMandatoryFields = ['eventName', 'eventType'];\nconst EventRow = /*#__PURE__*/React.memo(_c3 = _s2(props => {\n  _s2();\n\n  const classes = useFunctionBlockStyles();\n  const [valid, setValid] = useState({\n    eventName: {\n      error: false,\n      msg: ''\n    },\n    eventType: {\n      error: false,\n      msg: ''\n    }\n  });\n\n  const updateVars = evs => {\n    const updatedEvent = { ...props.event,\n      eventVariables: evs\n    };\n    props.setEvent(updatedEvent, props.index);\n  };\n\n  const validateField = useCallback(field => {\n    const inValid = props.event[field] === '';\n\n    if (eventMandatoryFields.includes(field)) {\n      if (inValid) setValid(prevValid => ({ ...prevValid,\n        [field]: {\n          msg: 'Mandatory',\n          error: true\n        }\n      }));\n    }\n\n    return !inValid;\n  }, [props.event]);\n  const validate = useCallback(() => {\n    const validName = validateField('eventName');\n    const validType = validateField('eventType');\n    return validName && validType;\n  }, [validateField]);\n  useEffect(() => {\n    if (!props.newEvent) validate();\n  }, [props.newEvent, props.event.eventName, props.event.eventType, validate]);\n\n  const action = () => {\n    if (validate()) props.addRemoveEvent(props.event);\n  };\n\n  const updateField = field => event => {\n    setValid(prevVal => ({ ...prevVal,\n      [field]: {\n        msg: '',\n        error: false\n      }\n    }));\n    props.setEvent({ ...props.event,\n      [field]: event.target.value\n    }, props.index);\n  };\n\n  return /*#__PURE__*/_jsxDEV(Grid, {\n    container: true,\n    direction: \"column\",\n    spacing: 1,\n    children: [/*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      container: true,\n      direction: \"row\",\n      justify: \"space-between\",\n      alignItems: \"center\",\n      children: [/*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 4,\n        children: /*#__PURE__*/_jsxDEV(TextField, {\n          value: props.event.eventName,\n          onChange: updateField('eventName'),\n          error: valid.eventName.error,\n          helperText: valid.eventName.msg,\n          fullWidth: true,\n          required: true,\n          label: \"Name\",\n          type: \"text\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 2,\n        children: /*#__PURE__*/_jsxDEV(TextField, {\n          value: props.event.eventOpcua || '',\n          onChange: updateField('eventOpcua'),\n          helperText: \"\",\n          fullWidth: true,\n          label: \"OPCUA\",\n          type: \"text\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 3,\n        children: /*#__PURE__*/_jsxDEV(TextField, {\n          value: props.event.eventType,\n          onChange: updateField('eventType'),\n          error: valid.eventType.error,\n          helperText: valid.eventType.msg,\n          fullWidth: true,\n          required: true,\n          label: \"Type\",\n          type: \"text\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 1,\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          onClick: action,\n          className: classes.varEvButton,\n          size: \"small\",\n          variant: \"contained\",\n          children: props.newEvent ? '+' : 'x'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      container: true,\n      direction: \"row\",\n      alignItems: \"center\",\n      spacing: 1,\n      children: [/*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        children: \"Variables\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        children: /*#__PURE__*/_jsxDEV(SearchableList, {\n          inList: props.event.eventVariables,\n          setInList: updateVars,\n          outList: props.nonUsedVariables(props.event),\n          showKey: \"evVariableName\",\n          newLabel: \"New Variable\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 125,\n    columnNumber: 5\n  }, this);\n}, \"oN6oMqU7cgDSpuI32/Z+5TOyZWI=\", false, function () {\n  return [useFunctionBlockStyles];\n}));\n_c4 = EventRow;\n\nvar _c, _c2, _c3, _c4;\n\n$RefreshReg$(_c, \"EventList$React.memo\");\n$RefreshReg$(_c2, \"EventList\");\n$RefreshReg$(_c3, \"EventRow$React.memo\");\n$RefreshReg$(_c4, \"EventRow\");","map":{"version":3,"sources":["/home/maria/Desktop/Marketplace-JurassicPark/backend/web/src/components/FunctionBlocks/FunctionBlock/Event.tsx"],"names":["React","useState","useEffect","useCallback","useFunctionBlockStyles","Grid","TextField","Button","SearchableList","EventList","memo","props","classes","getNonUsedVariables","event","variables","filter","variable","eventVariables","find","element","evVariableName","variableName","undefined","map","evEventName","eventName","updateVars","title","box","events","index","removeEvent","setEvent","addNewEvent","setNewEvent","newEvent","eventMandatoryFields","EventRow","valid","setValid","error","msg","eventType","evs","updatedEvent","validateField","field","inValid","includes","prevValid","validate","validName","validType","action","addRemoveEvent","updateField","prevVal","target","value","eventOpcua","varEvButton","nonUsedVariables"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback } from 'react'\nimport { useFunctionBlockStyles } from \"./style\"\nimport { Event, InOutType, Variable, EventVariable } from \"../../../model\"\nimport { Grid, TextField, Button } from \"@material-ui/core\"\nimport { SearchableList } from '../../templates/Search/SearchableList'\n\ninterface EventProps {\n  variables: Variable[]\n  events: Event[]\n  setEvents: Function\n  title: string\n  inOutType: InOutType\n  newEvent: Event\n  setNewEvent: Function\n  addNewEvent: (event:Event) => void\n  removeEvent: (event:Event) => void\n  setEvent: (event:Event, index:number) => void\n}\n\nexport const EventList = React.memo((props: EventProps) => {\n\n  const classes = useFunctionBlockStyles()\n\n  const getNonUsedVariables = useCallback((event: Event) : EventVariable[] => {\n\n    return props.variables.filter((variable: Variable) => \n      event.eventVariables\n        .find((element:EventVariable) => element.evVariableName === variable.variableName) === undefined)\n        .map((variable:Variable) => ({\n          evEventName:event.eventName,\n          evVariableName:variable.variableName\n        }))\n\n  },[props.variables])\n\n  const updateVars = useCallback((event:Event, eventVariables:EventVariable[]) => {\n\n    event.eventVariables = [...eventVariables]\n\n  },[])\n\n  return (\n    <Grid container direction=\"column\">\n      <Grid item>{props.title}</Grid>\n      <Grid item className={classes.box}>\n        {props.events.map((event:Event, index:number) => <EventRow updateVars={updateVars} key={index} index={index} addRemoveEvent={props.removeEvent} nonUsedVariables={getNonUsedVariables} setEvent={props.setEvent} event={event} newEvent={false} />)}\n        <EventRow addRemoveEvent={props.addNewEvent} setEvent={props.setNewEvent} updateVars={updateVars} nonUsedVariables={getNonUsedVariables} event={props.newEvent} newEvent={true} />\n      </Grid> \n    </Grid>\n  )\n}\n//,\n// (prevProps: EventProps, nextProps:EventProps) => prevProps.events === nextProps.events && prevProps.variables === nextProps.variables && prevProps.newEvent === nextProps.newEvent\n)\n\nconst eventMandatoryFields = ['eventName','eventType']\n\ninterface EventRowProps {\n  index?: number\n  addRemoveEvent: (event:Event) => void\n  setEvent:Function\n  updateVars:Function \n  nonUsedVariables:(event:Event) => EventVariable[] \n  event: Event\n  newEvent: boolean\n}\n\nconst EventRow = React.memo((props: EventRowProps) => {\n  \n  const classes = useFunctionBlockStyles()\n\n  const [valid, setValid] = useState({eventName:{error: false, msg: ''},eventType:{error:false,msg: ''}})\n\n  const updateVars = (evs:EventVariable[]) => {\n\n    const updatedEvent = {...props.event, eventVariables: evs}\n    props.setEvent(updatedEvent,props.index)\n\n  }\n\n  const validateField = useCallback((field:keyof Event) => {\n\n    const inValid = props.event[field] === ''\n\n    if(eventMandatoryFields.includes(field)) {\n      if(inValid)\n        setValid((prevValid:any) => ({...prevValid, [field]: {msg: 'Mandatory', error: true}}))\n    }\n      \n    return !inValid\n\n  },[props.event])\n\n  const validate = useCallback(() =>  {\n    \n    const validName = validateField('eventName')\n    const validType = validateField('eventType')\n    \n    return validName && validType\n  \n  },[validateField])\n\n  useEffect(() => {\n\n    if(!props.newEvent) \n      validate()\n  \n  }, [props.newEvent, props.event.eventName,props.event.eventType,validate])\n\n  const action = () => {\n\n    if(validate())\n      props.addRemoveEvent(props.event)\n\n  }\n\n  const updateField = (field: keyof Event) => (event:any) => {\n\n    setValid((prevVal) => ({...prevVal, [field]:{msg:'',error:false}}))\n    props.setEvent({...props.event, [field]: event.target.value},props.index)\n    \n  }\n\n  return (\n    <Grid container direction=\"column\" spacing={1}>\n      <Grid item container direction=\"row\" justify=\"space-between\" alignItems=\"center\">\n        <Grid item xs={4}>\n          <TextField value={props.event.eventName} onChange={updateField('eventName')} error={valid.eventName.error} helperText={valid.eventName.msg} fullWidth required label=\"Name\" type=\"text\" />\n        </Grid>\n        <Grid item xs={2}>\n          <TextField value={props.event.eventOpcua || ''} onChange={updateField('eventOpcua')} helperText=\"\" fullWidth label=\"OPCUA\" type=\"text\" />\n        </Grid>\n        <Grid item xs={3}>\n          <TextField value={props.event.eventType} onChange={updateField('eventType')} error={valid.eventType.error} helperText={valid.eventType.msg} fullWidth required label=\"Type\" type=\"text\" />\n        </Grid>\n        <Grid item xs={1}>\n          <Button onClick={action} className={classes.varEvButton} size=\"small\" variant=\"contained\">{props.newEvent ? '+' : 'x' }</Button>\n        </Grid>\n      </Grid>\n      <Grid item container direction=\"row\" alignItems=\"center\" spacing={1}>\n        <Grid item>\n          Variables\n        </Grid>\n        <Grid item>\n          <SearchableList inList={props.event.eventVariables} setInList={updateVars} outList={props.nonUsedVariables(props.event)} showKey=\"evVariableName\" newLabel=\"New Variable\"/>\n        </Grid>\n      </Grid>\n    </Grid>\n  )\n})"]},"metadata":{},"sourceType":"module"}