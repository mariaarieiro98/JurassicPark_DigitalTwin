{"ast":null,"code":"var _jsxFileName = \"/media/maria/96ae9a87-ebe3-48cb-a2c1-fae5fe76b9e7/maria/Marketplace-JurassicPark/backend/web/src/components/DigitalTwin/SmartComponent.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React, { useEffect, useState, useCallback } from 'react';\nimport { useFunctionBlockStyles } from \"../FunctionBlocks/FunctionBlock/style\";\nimport { DataType } from \"../../model/index\";\nimport { Grid, FormControl, InputLabel, Select, Button, MenuItem } from \"@material-ui/core\";\nimport { useMountEffect } from '../../utils/main';\nimport { getOrDownloadSmartComponents } from '../../utils/smartComponents';\nimport { useStore } from '../templates/Store/Store';\nimport { SmartComponentActions } from '../../redux/actions';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const SmartComponentList = /*#__PURE__*/React.memo(_c = _s(props => {\n  _s();\n\n  //   const {smartComponents, setSmartComponents,onSmartComponentRemoval, onSmartComponentEdition} = props\n  const classes = useFunctionBlockStyles(); //   const newSmartComponent : AssociatedSmartComponent= {\n  //     variableId: -1,\n  //     variableDataType: DataType.dtString,\n  //     variableOpcua: \"\",\n  //     variableInoutType: props.inOutType,\n  //     variableName: \"\",\n  //   }\n  //   const [newVariable,setNewVariable] : [Variable,Function] = useState(newVar)\n  //   const setVariable = useCallback((variable:Variable,index:number) => {\n  //     setSmartComponents((prevVars: Variable[]) => {\n  //       const oldVariable : Variable = prevVars[index]\n  //       const newVariables : Variable[] = [...prevVars]\n  //       newVariables[index] = variable\n  //       onVariableEdition(oldVariable,variable)\n  //       return newVariables\n  //     }) \n  //   },[onVariableEdition, setVariables])\n  //   const addSmartComponent = useCallback((scToAdd: SmartComponent) => {\n  //     setSmartComponents((prevVariables: Variable[]) =>[...prevVariables, varToAdd])\n  //     setNewVariable(newVar)\n  //   }, [setVariables,newVar]) \n  //   const removeVariable = useCallback((variableToRemove:Variable) => {\n  //     setVariables((prevVars: Variable[]) => prevVars.filter((variable:Variable,index:number) => variable !== variableToRemove))\n  //     onVariableRemoval(variableToRemove)\n  //   },[onVariableRemoval,setVariables]) \n\n  const [fetching, setFetching] = useState(true);\n  const {\n    data: smartComponents,\n    dispatchAction: dispatchSmartComponentActions\n  } = useStore('smartComponents');\n\n  const updateSmartComponents = scs => dispatchSmartComponentActions(SmartComponentActions.updateSmartComponent(scs));\n\n  const [error, setError] = useState(''); // Recuperar diretamente da comunicação OPC-UA os smart_components disponíveis (SmartComponent)\n\n  useMountEffect(() => {\n    setTimeout(() => {\n      setFetching(true);\n      getOrDownloadSmartComponents(smartComponents).then(result => updateSmartComponents(result)).catch(e => setError(e.msg)).finally(() => setFetching(false));\n    }, 0);\n  }); // Associar um smartComponent à funcionalidade\n\n  const [smartComponentChoice, setSmartComponentChoice] = useState('');\n  const [smartComponentIdChoice, setSmartComponentIdChoice] = useState(0);\n\n  const handleSmartComponentChoice = event => {\n    setSmartComponentChoice(event.target.value);\n    let i = 0;\n\n    while (i < smartComponents.length) {\n      if (smartComponents[i].scName === event.target.value) {\n        setSmartComponentIdChoice(smartComponents[i].scId);\n      }\n\n      i++;\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(Grid, {\n    container: true,\n    direction: \"column\",\n    children: [/*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      children: props.title\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      className: classes.box,\n      children: [/*#__PURE__*/_jsxDEV(InputLabel, {\n        id: `digital-twin-label-${smartComponents}`,\n        children: \"DINASORE\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(Select, {\n        labelId: `digital-twin-label-${smartComponents}`,\n        value: smartComponentChoice,\n        onChange: handleSmartComponentChoice,\n        children: (smartComponents || []).map(smartComponent => {\n          return /*#__PURE__*/_jsxDEV(MenuItem, {\n            value: smartComponent.scName,\n            children: smartComponent.scName\n          }, smartComponent.scId, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 79\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 97,\n    columnNumber: 5\n  }, this);\n}, \"4qZYERG6IlJU7o74Ttlie+/uYZc=\", false, function () {\n  return [useFunctionBlockStyles, useStore, useMountEffect];\n})); // interface VariableRowProps {\n//   index: number \n//   addRemoveVariable: (variable: Variable) => void\n//   setVariable:Function\n//   variable: Variable\n//   newVar: boolean\n//   order?: number\n// }\n\n_c2 = SmartComponentList;\nconst SmartComponentRow = /*#__PURE__*/React.memo(_c3 = _s2(props => {\n  _s2();\n\n  const classes = useFunctionBlockStyles();\n  const [validName, setValidName] = useState(\"\");\n\n  const action = () => {\n    if (!isValid() && props.newSmartComponent) setValidName(\"Mandatory\");else props.addRemoveSmartComponent(props.smartComponent);\n  };\n\n  const isValid = useCallback(() => props.smartComponent.scName !== '', [props.smartComponent]);\n  const validate = useCallback(() => {\n    !isValid() ? setValidName(\"Mandatory\") : setValidName('');\n  }, [isValid]);\n  useEffect(() => {\n    if (!props.newSmartComponent) validate();\n  }, [props.smartComponent.scName, props.newSmartComponent, validate]);\n\n  const updateField = field => event => {\n    setValidName('');\n    props.setSmartComponent({ ...props.smartComponent,\n      [field]: event.target.value\n    }, props.index);\n  };\n\n  return /*#__PURE__*/_jsxDEV(Grid, {\n    item: true,\n    container: true,\n    direction: \"row\",\n    justify: \"space-between\",\n    alignItems: \"center\",\n    children: [props.order ? /*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      xs: 1,\n      children: props.order\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 7\n    }, this) : null, /*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      xs: 3,\n      children: /*#__PURE__*/_jsxDEV(FormControl, {\n        fullWidth: true,\n        required: true,\n        children: [/*#__PURE__*/_jsxDEV(InputLabel, {\n          id: `data-type-label-${props.smartComponent.scName}`,\n          children: \"SmartComponents\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Select, {\n          labelId: `data-type-label-${props.smartComponent.scName}`,\n          value: props.smartComponent,\n          onChange: updateField('variableDataType'),\n          children: Object.values(DataType).map((dt, index) => /*#__PURE__*/_jsxDEV(MenuItem, {\n            value: dt,\n            children: dt\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 178,\n            columnNumber: 68\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      xs: 1,\n      children: /*#__PURE__*/_jsxDEV(Button, {\n        className: classes.varEvButton,\n        size: \"small\",\n        variant: \"contained\",\n        onClick: action,\n        children: props.newSmartComponent ? '+' : 'x'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 163,\n    columnNumber: 5\n  }, this);\n}, \"Ki16XzEneQsNhUTQv+ig9YkjeRk=\", false, function () {\n  return [useFunctionBlockStyles];\n}), (prevProps, nextProps) => prevProps.smartComponent === nextProps.smartComponent);\n_c4 = SmartComponentRow;\n\nfunction setFetching(arg0) {\n  throw new Error('Function not implemented.');\n}\n\nfunction setError(msg) {\n  throw new Error('Function not implemented.');\n}\n\nvar _c, _c2, _c3, _c4;\n\n$RefreshReg$(_c, \"SmartComponentList$React.memo\");\n$RefreshReg$(_c2, \"SmartComponentList\");\n$RefreshReg$(_c3, \"SmartComponentRow$React.memo\");\n$RefreshReg$(_c4, \"SmartComponentRow\");","map":{"version":3,"sources":["/media/maria/96ae9a87-ebe3-48cb-a2c1-fae5fe76b9e7/maria/Marketplace-JurassicPark/backend/web/src/components/DigitalTwin/SmartComponent.tsx"],"names":["React","useEffect","useState","useCallback","useFunctionBlockStyles","DataType","Grid","FormControl","InputLabel","Select","Button","MenuItem","useMountEffect","getOrDownloadSmartComponents","useStore","SmartComponentActions","SmartComponentList","memo","props","classes","fetching","setFetching","data","smartComponents","dispatchAction","dispatchSmartComponentActions","updateSmartComponents","scs","updateSmartComponent","error","setError","setTimeout","then","result","catch","e","msg","finally","smartComponentChoice","setSmartComponentChoice","smartComponentIdChoice","setSmartComponentIdChoice","handleSmartComponentChoice","event","target","value","i","length","scName","scId","title","box","map","smartComponent","SmartComponentRow","validName","setValidName","action","isValid","newSmartComponent","addRemoveSmartComponent","validate","updateField","field","setSmartComponent","index","order","Object","values","dt","varEvButton","prevProps","nextProps","arg0","Error"],"mappings":";;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,EAAqCC,WAArC,QAAwD,OAAxD;AACA,SAASC,sBAAT,QAAuC,uCAAvC;AACA,SAAmBC,QAAnB,QAAwF,mBAAxF;AACA,SAASC,IAAT,EAAeC,WAAf,EAA4BC,UAA5B,EAAwCC,MAAxC,EAAgDC,MAAhD,EAAwDC,QAAxD,QAAwE,mBAAxE;AACA,SAASC,cAAT,QAA+B,kBAA/B;AACA,SAASC,4BAAT,QAA6C,6BAA7C;AAEA,SAASC,QAAT,QAAyB,0BAAzB;AACA,SAASC,qBAAT,QAAsC,qBAAtC;;AAUA,OAAO,MAAMC,kBAAkB,gBAAGhB,KAAK,CAACiB,IAAN,SAAYC,KAAD,IAAgC;AAAA;;AAE7E;AAEG,QAAMC,OAAO,GAAGf,sBAAsB,EAAtC,CAJ0E,CAM7E;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAEA;AAEA;AAEA;AACA;AAEA;AAEA;AACA;AACA;AACA;;AAEE,QAAM,CAACgB,QAAD,EAAUC,WAAV,IAAyBnB,QAAQ,CAAC,IAAD,CAAvC;AACA,QAAM;AAACoB,IAAAA,IAAI,EAACC,eAAN;AAAuBC,IAAAA,cAAc,EAACC;AAAtC,MAAuEX,QAAQ,CAAC,iBAAD,CAArF;;AACA,QAAMY,qBAAqB,GAAIC,GAAD,IAA2BF,6BAA6B,CAACV,qBAAqB,CAACa,oBAAtB,CAA2CD,GAA3C,CAAD,CAAtF;;AACA,QAAM,CAACE,KAAD,EAAOC,QAAP,IAAmB5B,QAAQ,CAAC,EAAD,CAAjC,CA7C2E,CA+C1E;;AACAU,EAAAA,cAAc,CAAC,MAAM;AAEpBmB,IAAAA,UAAU,CAAC,MAAM;AAEjBV,MAAAA,WAAW,CAAC,IAAD,CAAX;AACAR,MAAAA,4BAA4B,CAACU,eAAD,CAA5B,CACKS,IADL,CACWC,MAAD,IAA8BP,qBAAqB,CAACO,MAAD,CAD7D,EAEKC,KAFL,CAEYC,CAAD,IAA4BL,QAAQ,CAACK,CAAC,CAACC,GAAH,CAF/C,EAGKC,OAHL,CAGa,MAAMhB,WAAW,CAAC,KAAD,CAH9B;AAIC,KAPS,EAOP,CAPO,CAAV;AAQC,GAVY,CAAd,CAhD0E,CA4DzE;;AACA,QAAM,CAACiB,oBAAD,EAAuBC,uBAAvB,IAAkDrC,QAAQ,CAAC,EAAD,CAAhE;AACA,QAAM,CAACsC,sBAAD,EAAyBC,yBAAzB,IAAsDvC,QAAQ,CAAC,CAAD,CAApE;;AAEA,QAAMwC,0BAA0B,GAAIC,KAAD,IAAkD;AACrFJ,IAAAA,uBAAuB,CAACI,KAAK,CAACC,MAAN,CAAaC,KAAd,CAAvB;AACA,QAAIC,CAAC,GAAG,CAAR;;AACA,WAAMA,CAAC,GAAGvB,eAAe,CAACwB,MAA1B,EACA;AACI,UAAIxB,eAAe,CAACuB,CAAD,CAAf,CAAmBE,MAAnB,KAA+BL,KAAK,CAACC,MAAN,CAAaC,KAAhD,EACA;AACIJ,QAAAA,yBAAyB,CAAClB,eAAe,CAACuB,CAAD,CAAf,CAAmBG,IAApB,CAAzB;AACH;;AACDH,MAAAA,CAAC;AACJ;AACA,GAXD;;AAaF,sBACE,QAAC,IAAD;AAAM,IAAA,SAAS,MAAf;AAAgB,IAAA,SAAS,EAAC,QAA1B;AAAA,4BACE,QAAC,IAAD;AAAM,MAAA,IAAI,MAAV;AAAA,gBAAY5B,KAAK,CAACgC;AAAlB;AAAA;AAAA;AAAA;AAAA,YADF,eAEE,QAAC,IAAD;AAAM,MAAA,IAAI,MAAV;AAAW,MAAA,SAAS,EAAE/B,OAAO,CAACgC,GAA9B;AAAA,8BACM,QAAC,UAAD;AAAY,QAAA,EAAE,EAAG,sBAAqB5B,eAAgB,EAAtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADN,eAEU,QAAC,MAAD;AAAQ,QAAA,OAAO,EAAG,sBAAqBA,eAAgB,EAAvD;AAA0D,QAAA,KAAK,EAAEe,oBAAjE;AAAuF,QAAA,QAAQ,EAAEI,0BAAjG;AAAA,kBACC,CAACnB,eAAe,IAAI,EAApB,EAAwB6B,GAAxB,CAA6BC,cAAD,IAAyB;AAAC,8BAAO,QAAC,QAAD;AAAoC,YAAA,KAAK,EAAEA,cAAc,CAACL,MAA1D;AAAA,sBAAmEK,cAAc,CAACL;AAAlF,aAAeK,cAAc,CAACJ,IAA9B;AAAA;AAAA;AAAA;AAAA,kBAAP;AAA4G,SAAlK;AADD;AAAA;AAAA;AAAA;AAAA,cAFV;AAAA;AAAA;AAAA;AAAA;AAAA,YAFF;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AAaD,CA1FiC;AAAA,UAIf7C,sBAJe,EA2C6CU,QA3C7C,EAgD/BF,cAhD+B;AAAA,GAA3B,C,CA4FP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;MAnGaI,kB;AA8Gb,MAAMsC,iBAAiB,gBAAGtD,KAAK,CAACiB,IAAN,WAAYC,KAAD,IAAmC;AAAA;;AAEtE,QAAMC,OAAO,GAAGf,sBAAsB,EAAtC;AAEA,QAAM,CAACmD,SAAD,EAAWC,YAAX,IAA2BtD,QAAQ,CAAC,EAAD,CAAzC;;AAEA,QAAMuD,MAAM,GAAG,MAAM;AAEnB,QAAG,CAACC,OAAO,EAAR,IAAcxC,KAAK,CAACyC,iBAAvB,EACEH,YAAY,CAAC,WAAD,CAAZ,CADF,KAIEtC,KAAK,CAAE0C,uBAAP,CAA+B1C,KAAK,CAACmC,cAArC;AAEH,GARD;;AAUA,QAAMK,OAAO,GAAGvD,WAAW,CAAC,MAAMe,KAAK,CAACmC,cAAN,CAAqBL,MAArB,KAAgC,EAAvC,EAA2C,CAAC9B,KAAK,CAACmC,cAAP,CAA3C,CAA3B;AAEA,QAAMQ,QAAQ,GAAG1D,WAAW,CAAC,MAAM;AAEjC,KAACuD,OAAO,EAAR,GAAaF,YAAY,CAAC,WAAD,CAAzB,GAAyCA,YAAY,CAAC,EAAD,CAArD;AAED,GAJ2B,EAI1B,CAACE,OAAD,CAJ0B,CAA5B;AAMAzD,EAAAA,SAAS,CAAC,MAAM;AAAC,QAAG,CAACiB,KAAK,CAACyC,iBAAV,EAA6BE,QAAQ;AAAG,GAAhD,EAAkD,CAAC3C,KAAK,CAACmC,cAAN,CAAqBL,MAAtB,EAA8B9B,KAAK,CAACyC,iBAApC,EAAuDE,QAAvD,CAAlD,CAAT;;AAEA,QAAMC,WAAW,GAAIC,KAAD,IAAmBpB,KAAD,IAAe;AAEnDa,IAAAA,YAAY,CAAC,EAAD,CAAZ;AACAtC,IAAAA,KAAK,CAAE8C,iBAAP,CAAyB,EAAC,GAAG9C,KAAK,CAACmC,cAAV;AAA0B,OAACU,KAAD,GAASpB,KAAK,CAACC,MAAN,CAAaC;AAAhD,KAAzB,EAAgF3B,KAAK,CAAC+C,KAAtF;AAED,GALD;;AAOA,sBACE,QAAC,IAAD;AAAM,IAAA,IAAI,MAAV;AAAW,IAAA,SAAS,MAApB;AAAqB,IAAA,SAAS,EAAC,KAA/B;AAAqC,IAAA,OAAO,EAAC,eAA7C;AAA6D,IAAA,UAAU,EAAC,QAAxE;AAAA,eACI/C,KAAK,CAACgD,KAAN,gBACF,QAAC,IAAD;AAAM,MAAA,IAAI,MAAV;AAAW,MAAA,EAAE,EAAE,CAAf;AAAA,gBACKhD,KAAK,CAACgD;AADX;AAAA;AAAA;AAAA;AAAA,YADE,GAIA,IALJ,eAOE,QAAC,IAAD;AAAM,MAAA,IAAI,MAAV;AAAW,MAAA,EAAE,EAAE,CAAf;AAAA,6BACE,QAAC,WAAD;AAAa,QAAA,SAAS,MAAtB;AAAuB,QAAA,QAAQ,MAA/B;AAAA,gCACE,QAAC,UAAD;AAAY,UAAA,EAAE,EAAG,mBAAkBhD,KAAK,CAACmC,cAAN,CAAqBL,MAAO,EAA/D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAEE,QAAC,MAAD;AACE,UAAA,OAAO,EAAG,mBAAkB9B,KAAK,CAACmC,cAAN,CAAqBL,MAAO,EAD1D;AAEE,UAAA,KAAK,EAAE9B,KAAK,CAACmC,cAFf;AAGE,UAAA,QAAQ,EAAES,WAAW,CAAC,kBAAD,CAHvB;AAAA,oBAKGK,MAAM,CAACC,MAAP,CAAc/D,QAAd,EAAwB+C,GAAxB,CAA4B,CAACiB,EAAD,EAASJ,KAAT,kBAA0B,QAAC,QAAD;AAAsB,YAAA,KAAK,EAAEI,EAA7B;AAAA,sBAAkCA;AAAlC,aAAeJ,KAAf;AAAA;AAAA;AAAA;AAAA,kBAAtD;AALH;AAAA;AAAA;AAAA;AAAA,gBAFF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YAPF,eAoBE,QAAC,IAAD;AAAM,MAAA,IAAI,MAAV;AAAW,MAAA,EAAE,EAAE,CAAf;AAAA,6BACE,QAAC,MAAD;AACE,QAAA,SAAS,EAAE9C,OAAO,CAACmD,WADrB;AAEE,QAAA,IAAI,EAAC,OAFP;AAGE,QAAA,OAAO,EAAC,WAHV;AAIE,QAAA,OAAO,EAAEb,MAJX;AAAA,kBAMCvC,KAAK,CAACyC,iBAAN,GAA0B,GAA1B,GAAgC;AANjC;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YApBF;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AAgCD,CAjEyB;AAAA,UAERvD,sBAFQ;AAAA,IAkExB,CAACmE,SAAD,EAAmCC,SAAnC,KAAyED,SAAS,CAAClB,cAAV,KAA6BmB,SAAS,CAACnB,cAlExF,CAA1B;MAAMC,iB;;AAqEN,SAASjC,WAAT,CAAqBoD,IAArB,EAAoC;AAChC,QAAM,IAAIC,KAAJ,CAAU,2BAAV,CAAN;AACH;;AACD,SAAS5C,QAAT,CAAkBM,GAAlB,EAAiC;AAC7B,QAAM,IAAIsC,KAAJ,CAAU,2BAAV,CAAN;AACH","sourcesContent":["import React, { useEffect, useState, useCallback } from 'react'\nimport { useFunctionBlockStyles } from \"../FunctionBlocks/FunctionBlock/style\"\nimport { Variable, DataType, InOutType, SmartComponent, AssociatedSmartComponent } from \"../../model/index\"\nimport { Grid, FormControl, InputLabel, Select, Button, MenuItem } from \"@material-ui/core\"\nimport { useMountEffect } from '../../utils/main'\nimport { getOrDownloadSmartComponents } from '../../utils/smartComponents'\nimport { RequestResponseState } from '../../services/api/api'\nimport { useStore } from '../templates/Store/Store'\nimport { SmartComponentActions } from '../../redux/actions'\n\ninterface SmartComponentProps {\n    setSmartComponents: Function\n    smartComponents: AssociatedSmartComponent[]\n    title: string\n    onSmartComponentRemoval: (smartComponent: SmartComponent) => void\n    onSmartComponentEdition: (oldSmartComponent: AssociatedSmartComponent, newSmartComponent: AssociatedSmartComponent) => void\n}\n\nexport const SmartComponentList = React.memo((props: SmartComponentProps) => {\n  \n//   const {smartComponents, setSmartComponents,onSmartComponentRemoval, onSmartComponentEdition} = props\n\n   const classes = useFunctionBlockStyles()\n\n//   const newSmartComponent : AssociatedSmartComponent= {\n//     variableId: -1,\n//     variableDataType: DataType.dtString,\n//     variableOpcua: \"\",\n//     variableInoutType: props.inOutType,\n//     variableName: \"\",\n//   }\n\n//   const [newVariable,setNewVariable] : [Variable,Function] = useState(newVar)\n\n//   const setVariable = useCallback((variable:Variable,index:number) => {\n\n//     setSmartComponents((prevVars: Variable[]) => {\n\n//       const oldVariable : Variable = prevVars[index]\n//       const newVariables : Variable[] = [...prevVars]\n//       newVariables[index] = variable\n//       onVariableEdition(oldVariable,variable)\n//       return newVariables\n\n//     }) \n\n//   },[onVariableEdition, setVariables])\n\n//   const addSmartComponent = useCallback((scToAdd: SmartComponent) => {\n    \n//     setSmartComponents((prevVariables: Variable[]) =>[...prevVariables, varToAdd])\n//     setNewVariable(newVar)\n\n//   }, [setVariables,newVar]) \n\n//   const removeVariable = useCallback((variableToRemove:Variable) => {\n//     setVariables((prevVars: Variable[]) => prevVars.filter((variable:Variable,index:number) => variable !== variableToRemove))\n//     onVariableRemoval(variableToRemove)\n//   },[onVariableRemoval,setVariables]) \n\n  const [fetching,setFetching] = useState(true)\n  const {data:smartComponents, dispatchAction:dispatchSmartComponentActions} = useStore('smartComponents')\n  const updateSmartComponents = (scs: SmartComponent[]) => dispatchSmartComponentActions(SmartComponentActions.updateSmartComponent(scs))\n  const [error,setError] = useState('')\n\n   // Recuperar diretamente da comunicação OPC-UA os smart_components disponíveis (SmartComponent)\n   useMountEffect(() => {\n\n    setTimeout(() => {\n\n    setFetching(true)\n    getOrDownloadSmartComponents(smartComponents)\n        .then((result: SmartComponent[]) => updateSmartComponents(result))\n        .catch((e:RequestResponseState) => setError(e.msg))\n        .finally(() => setFetching(false))\n    }, 0)\n    })\n\n    // Associar um smartComponent à funcionalidade\n    const [smartComponentChoice, setSmartComponentChoice] = useState('')\n    const [smartComponentIdChoice, setSmartComponentIdChoice] = useState(0)\n\n    const handleSmartComponentChoice = (event: React.ChangeEvent<{ value: unknown }>) => {\n    setSmartComponentChoice(event.target.value as string);\n    let i = 0;\n    while(i < smartComponents.length)\n    {\n        if( smartComponents[i].scName === (event.target.value as string))\n        {\n            setSmartComponentIdChoice(smartComponents[i].scId)\n        }\n        i++;\n    }\n    };\n\n  return (\n    <Grid container direction=\"column\">\n      <Grid item>{props.title}</Grid>\n      <Grid item className={classes.box}>\n            <InputLabel id={`digital-twin-label-${smartComponents}`}>DINASORE</InputLabel>\n                <Select labelId={`digital-twin-label-${smartComponents}`} value={smartComponentChoice} onChange={handleSmartComponentChoice}>\n                {(smartComponents || []).map((smartComponent: any) => {return <MenuItem key={smartComponent.scId} value={smartComponent.scName}>{smartComponent.scName}</MenuItem>})}\n                </Select> \n        {/* {smartComponents.map((smartComponent:SmartComponent, index:number) => <SmartComponentRowProps key={index} index={index} addRemoveSmartComponent={removeVariable} setVariable={setVariable} smartComponent={smartComponent} newSmartComponent={false} />)}\n        <SmartComponentRowProps index={-1} addRemoveSmartComponent={addVariable} setVariable={setNewVariable} variable={newVariable} newSmartComponent={true}  /> */}\n      </Grid> \n    </Grid>\n  )\n})\n\n// interface VariableRowProps {\n//   index: number \n//   addRemoveVariable: (variable: Variable) => void\n//   setVariable:Function\n//   variable: Variable\n//   newVar: boolean\n//   order?: number\n// }\n\ninterface SmartComponentRowProps {\n    index: number \n    addRemoveSmartComponent: (smartComponent: SmartComponent) => void\n    setSmartComponent:Function\n    smartComponent: SmartComponent\n    newSmartComponent: boolean\n    order?: number\n}\n  \nconst SmartComponentRow = React.memo((props: SmartComponentRowProps) => {\n\n  const classes = useFunctionBlockStyles()\n\n  const [validName,setValidName] = useState(\"\")\n\n  const action = () => {\n\n    if(!isValid() && props.newSmartComponent) \n      setValidName(\"Mandatory\")\n    \n    else\n      props. addRemoveSmartComponent(props.smartComponent)\n    \n  }\n\n  const isValid = useCallback(() => props.smartComponent.scName !== '', [props.smartComponent])\n\n  const validate = useCallback(() => {\n    \n    !isValid() ? setValidName(\"Mandatory\") : setValidName('')\n\n  },[isValid]) \n\n  useEffect(() => {if(!props.newSmartComponent) validate()}, [props.smartComponent.scName, props.newSmartComponent, validate])\n\n  const updateField = (field:string) => (event:any) => {\n\n    setValidName('')\n    props. setSmartComponent({...props.smartComponent, [field]: event.target.value},props.index)\n  \n  }\n\n  return (\n    <Grid item container direction=\"row\" justify=\"space-between\" alignItems=\"center\">\n      { props.order ?\n      <Grid item xs={1}>\n          {props.order}\n      </Grid>\n      : null\n      }\n      <Grid item xs={3}>\n        <FormControl fullWidth required>\n          <InputLabel id={`data-type-label-${props.smartComponent.scName}`}>SmartComponents</InputLabel>\n          <Select\n            labelId={`data-type-label-${props.smartComponent.scName}`}\n            value={props.smartComponent}\n            onChange={updateField('variableDataType')}\n          >\n            {Object.values(DataType).map((dt:any, index:number) => <MenuItem key={index} value={dt}>{dt}</MenuItem>)}\n\n          </Select>\n        </FormControl>\n      </Grid>\n      <Grid item xs={1}>\n        <Button \n          className={classes.varEvButton} \n          size=\"small\" \n          variant=\"contained\"\n          onClick={action}\n        >\n        {props.newSmartComponent ? '+' : 'x' }</Button>\n      </Grid>\n    </Grid>\n  )\n}\n ,(prevProps:SmartComponentRowProps, nextProps: SmartComponentRowProps) => prevProps.smartComponent === nextProps.smartComponent\n)\n\nfunction setFetching(arg0: boolean) {\n    throw new Error('Function not implemented.')\n}\nfunction setError(msg: any): any {\n    throw new Error('Function not implemented.')\n}\n\n"]},"metadata":{},"sourceType":"module"}