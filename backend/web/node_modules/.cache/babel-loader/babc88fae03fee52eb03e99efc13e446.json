{"ast":null,"code":"var _jsxFileName = \"/home/maria/Desktop/Marketplace-JurassicPark/backend/web/src/components/DigitalTwin/DigitalTwinMonitoring.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport { Navigator } from '../templates/Navigator/Navigator';\nimport { deleteFunctionBlock } from '../../services/api/function-block';\nimport { useMountEffect } from '../../utils/main';\nimport { JPTable } from '../templates/Table/JPTable';\nimport { LazyComponent } from '../templates/LazyComponent/LazyComponent';\nimport { ConfirmAction, ConfirmActionStateLabel } from '../templates/ConfirmAction/ConfirmAction';\nimport { setTimeout } from 'timers';\nimport { FunctionalityActions } from '../../redux/actions';\nimport { Redirect } from 'react-router-dom';\nimport { useStore } from '../templates/Store/Store';\nimport { getOrDownloadFunctionalities } from '../../utils/digitalTwins';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const DigitalTwinMonitoring = () => {\n  _s();\n\n  const {\n    data: functionalities,\n    dispatchAction: dispatchFunctionalitiesActions\n  } = useStore('functionalities');\n  const [fetching, setFetching] = useState(true);\n  const [error, setError] = useState('');\n  const [redirectToEdit, setRedirectToEdit] = useState(-1);\n  const [redirectToAddVariableEvent, setRedirectToAddVariableEvent] = useState(-1);\n  const [redirectToFunctionalityDetails, setRedirectToFunctionalityDetails] = useState(-1);\n\n  const updateFunctionalities = funcs => dispatchFunctionalitiesActions(FunctionalityActions.updateFunctionalities(funcs));\n\n  useMountEffect(() => {\n    setTimeout(() => {\n      setFetching(true);\n      getOrDownloadFunctionalities(functionalities).then(result => {\n        updateFunctionalities(result);\n      }).catch(e => setError(e.msg)).finally(() => setFetching(false));\n    }, 0);\n  });\n  const errorState = {\n    label: error,\n    state: ConfirmActionStateLabel.error,\n    positiveLabel: 'Ok'\n  };\n  const indexes = [{\n    label: 'Functionality',\n    key: 'dtFunctionality'\n  } //{label: 'Digital Twin', key: 'dt'},\n  //{label: 'State', key: 'state'},\n  //{label: 'State', key: 'dtDescription'},\n  //{label: 'AssociatedSmartComponents', key: 'dtSmartComponents'},\n  //{label: 'Monitored Variables/Events', key: 'dtMonitoredVariableEvent'},\n  //{label: 'Add Variables/Events', key: 'dtAddVariableEvent'},\n  //{label: 'Details', key: 'dtDetails'},\n  ];\n\n  const onCancel = () => setError('');\n\n  const deleteLocalFunctionality = func => dispatchFunctionalitiesActions(FunctionalityActions.deleteFunctionality(func));\n\n  const deleteFunctionalityAction = func => {\n    return new Promise(async (res, rej) => {\n      setTimeout(async () => {\n        if (!func.funcId) {\n          rej('Error');\n          return;\n        }\n\n        try {\n          const response = await deleteFunctionBlock(func.funcId);\n          res(response);\n        } catch (err) {\n          rej(err);\n        }\n      }, 0);\n    });\n  };\n\n  const editFunctionalityAction = func => {\n    setRedirectToEdit(func.funcId);\n  };\n\n  if (redirectToEdit !== -1) return /*#__PURE__*/_jsxDEV(Redirect, {\n    to: `/function-block/${redirectToEdit}`,\n    push: true\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 99,\n    columnNumber: 12\n  }, this); // Função para adicionar variável/evento\n\n  const AddVariableEventAction = func => {\n    setRedirectToAddVariableEvent(func.funcId);\n  }; // Função para visualizar details do DT\n\n\n  const DetailsAction = func => {\n    setRedirectToFunctionalityDetails(func.funcId);\n  };\n\n  if (redirectToAddVariableEvent !== -1) return /*#__PURE__*/_jsxDEV(Redirect, {\n    to: `/functionality/:id/${redirectToAddVariableEvent}`,\n    push: true\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 112,\n    columnNumber: 13\n  }, this);\n  if (redirectToFunctionalityDetails !== -1) return /*#__PURE__*/_jsxDEV(Redirect, {\n    to: `/functionality-details/:id/${redirectToFunctionalityDetails}`,\n    push: true\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 115,\n    columnNumber: 13\n  }, this);\n  return /*#__PURE__*/_jsxDEV(Navigator, {\n    title: \"Digital Twin Monitoring\",\n    children: /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [error !== '' ? /*#__PURE__*/_jsxDEV(ConfirmAction, {\n        title: \"Fetching Functionalities\",\n        currentState: errorState,\n        states: {\n          error: errorState\n        },\n        onCancel: onCancel\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 11\n      }, this) : null, /*#__PURE__*/_jsxDEV(LazyComponent, {\n        loaded: !fetching,\n        children: /*#__PURE__*/_jsxDEV(JPTable, {\n          data: functionalities,\n          updateData: updateFunctionalities,\n          indexes: indexes,\n          sortedkey: \"funcName\",\n          tName: \"Functionality\",\n          extra: {\n            delete: {\n              action: deleteFunctionalityAction,\n              labelKey: 'funcName',\n              onSuccessDelete: deleteLocalFunctionality\n            },\n            edit: {\n              action: editFunctionalityAction\n            }\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 118,\n    columnNumber: 5\n  }, this);\n};\n\n_s(DigitalTwinMonitoring, \"L+HWo5A34i0W4ipZgYXBvcATflw=\", false, function () {\n  return [useStore, useMountEffect];\n});\n\n_c = DigitalTwinMonitoring;\n\nvar _c;\n\n$RefreshReg$(_c, \"DigitalTwinMonitoring\");","map":{"version":3,"sources":["/home/maria/Desktop/Marketplace-JurassicPark/backend/web/src/components/DigitalTwin/DigitalTwinMonitoring.tsx"],"names":["React","useState","Navigator","deleteFunctionBlock","useMountEffect","JPTable","LazyComponent","ConfirmAction","ConfirmActionStateLabel","setTimeout","FunctionalityActions","Redirect","useStore","getOrDownloadFunctionalities","DigitalTwinMonitoring","data","functionalities","dispatchAction","dispatchFunctionalitiesActions","fetching","setFetching","error","setError","redirectToEdit","setRedirectToEdit","redirectToAddVariableEvent","setRedirectToAddVariableEvent","redirectToFunctionalityDetails","setRedirectToFunctionalityDetails","updateFunctionalities","funcs","then","result","catch","e","msg","finally","errorState","label","state","positiveLabel","indexes","key","onCancel","deleteLocalFunctionality","func","deleteFunctionality","deleteFunctionalityAction","Promise","res","rej","funcId","response","err","editFunctionalityAction","AddVariableEventAction","DetailsAction","delete","action","labelKey","onSuccessDelete","edit"],"mappings":"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","sourcesContent":["import React, { useState } from 'react'\r\nimport { Navigator } from '../templates/Navigator/Navigator'\r\nimport { deleteFunctionBlock } from '../../services/api/function-block'\r\nimport { Functionality, FunctionBlock } from '../../model/index'\r\nimport { useMountEffect } from '../../utils/main'\r\nimport { JPTable } from '../templates/Table/JPTable'\r\nimport { LazyComponent } from '../templates/LazyComponent/LazyComponent'\r\nimport { ConfirmAction, ConfirmActionState, ConfirmActionStateLabel } from '../templates/ConfirmAction/ConfirmAction'\r\nimport { RequestResponseState } from '../../services/api/api'\r\nimport { setTimeout } from 'timers'\r\nimport { FunctionalityActions } from '../../redux/actions'\r\nimport { Redirect } from 'react-router-dom'\r\nimport { useStore } from '../templates/Store/Store'\r\nimport { getOrDownloadFunctionalities } from '../../utils/digitalTwins'\r\n\r\nexport const DigitalTwinMonitoring = () => {\r\n  \r\n  const {data:functionalities,dispatchAction:dispatchFunctionalitiesActions} = useStore('functionalities')\r\n\r\n  const [fetching,setFetching] = useState(true)\r\n  const [error,setError] = useState('')\r\n\r\n  const [redirectToEdit,setRedirectToEdit] : [number, Function] = useState(-1)\r\n  const [redirectToAddVariableEvent,setRedirectToAddVariableEvent] : [number, Function] = useState(-1)\r\n  const [redirectToFunctionalityDetails,setRedirectToFunctionalityDetails] : [number, Function] = useState(-1)\r\n\r\n  const updateFunctionalities = (funcs: Functionality[]) => dispatchFunctionalitiesActions(FunctionalityActions.updateFunctionalities(funcs))\r\n  \r\n  useMountEffect(() => {\r\n\r\n    setTimeout(() => {\r\n\r\n      setFetching(true)\r\n      getOrDownloadFunctionalities(functionalities)\r\n          .then((result: Functionality[]) => {\r\n              updateFunctionalities(result)\r\n          })\r\n          .catch((e:RequestResponseState) => setError(e.msg))\r\n          .finally(() => setFetching(false))\r\n\r\n        \r\n    }, 0)\r\n\r\n  })\r\n\r\n  const errorState : ConfirmActionState = {\r\n    label: error,\r\n    state: ConfirmActionStateLabel.error,\r\n    positiveLabel: 'Ok'\r\n  }\r\n\r\n  const indexes = [\r\n    {label: 'Functionality', key: 'dtFunctionality'},\r\n    //{label: 'Digital Twin', key: 'dt'},\r\n    //{label: 'State', key: 'state'},\r\n    //{label: 'State', key: 'dtDescription'},\r\n    //{label: 'AssociatedSmartComponents', key: 'dtSmartComponents'},\r\n    //{label: 'Monitored Variables/Events', key: 'dtMonitoredVariableEvent'},\r\n    //{label: 'Add Variables/Events', key: 'dtAddVariableEvent'},\r\n    //{label: 'Details', key: 'dtDetails'},\r\n  ]\r\n\r\n  const onCancel = () => setError('')\r\n\r\n  const deleteLocalFunctionality = (func: Functionality) => dispatchFunctionalitiesActions(FunctionalityActions.deleteFunctionality(func))\r\n\r\n  const deleteFunctionalityAction = (func: Functionality) : Promise<any> => {\r\n\r\n    return new Promise(async (res:Function, rej: Function) => {\r\n\r\n      setTimeout(async () => {\r\n\r\n          if(!func.funcId) {\r\n            rej('Error')\r\n            return\r\n          }\r\n\r\n          try {\r\n            const response : RequestResponseState = await deleteFunctionBlock(func.funcId)\r\n            res(response)\r\n          }\r\n\r\n          catch(err) {\r\n            rej(err)\r\n          }\r\n      }, 0)\r\n\r\n    })\r\n\r\n  } \r\n\r\n  const editFunctionalityAction = (func: Functionality) => {\r\n\r\n    setRedirectToEdit(func.funcId)\r\n\r\n  }\r\n\r\n  if(redirectToEdit !== -1)\r\n    return <Redirect to={`/function-block/${redirectToEdit}`} push={true}/>\r\n  \r\n    // Função para adicionar variável/evento\r\n   const AddVariableEventAction = (func: Functionality) => {\r\n     setRedirectToAddVariableEvent(func.funcId)\r\n   }\r\n\r\n   // Função para visualizar details do DT\r\n   const DetailsAction = (func: Functionality) => {\r\n     setRedirectToFunctionalityDetails(func.funcId)\r\n   }\r\n\r\n  if(redirectToAddVariableEvent !== -1)\r\n     return <Redirect to={`/functionality/:id/${redirectToAddVariableEvent}`} push={true}/>\r\n\r\n  if(redirectToFunctionalityDetails !== -1)\r\n     return <Redirect to={`/functionality-details/:id/${redirectToFunctionalityDetails}`} push={true}/>\r\n\r\n  return (\r\n    <Navigator title=\"Digital Twin Monitoring\">\r\n      <> \r\n        {error !== ''\r\n        ? <ConfirmAction title='Fetching Functionalities' currentState={errorState} states={{error: errorState}} onCancel={onCancel}/>\r\n        : null \r\n        }\r\n        <LazyComponent loaded={!fetching}>\r\n          <JPTable\r\n            data={functionalities} \r\n            updateData={updateFunctionalities} \r\n            indexes={indexes}\r\n            sortedkey='funcName' \r\n            tName='Functionality'\r\n            extra={{\r\n              delete: {\r\n                action: deleteFunctionalityAction,\r\n                labelKey: 'funcName',\r\n                onSuccessDelete: deleteLocalFunctionality\r\n              },\r\n              edit: {\r\n                action: editFunctionalityAction \r\n              }\r\n            }} \r\n            />\r\n        </LazyComponent>\r\n      </>\r\n    </Navigator>\r\n  )\r\n\r\n}"]},"metadata":{},"sourceType":"module"}