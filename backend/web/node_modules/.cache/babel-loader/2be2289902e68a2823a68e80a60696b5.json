{"ast":null,"code":"var _jsxFileName = \"/media/maria/96ae9a87-ebe3-48cb-a2c1-fae5fe76b9e7/maria/Marketplace-JurassicPark/backend/web/src/components/DigitalTwin/NewDigitalTwin.tsx\";\nimport React, { useState } from 'react';\nimport { Navigator } from '../templates/Navigator/Navigator';\nimport { Redirect } from 'react-router-dom';\nimport { routes } from '../../App';\nimport { ConfirmActionStateLabel } from '../templates/ConfirmAction/ConfirmAction';\nimport { DigitalTwinForm } from './DigitalTwinForm';\nimport { useMountEffect } from '../../utils/main';\nimport { useStore } from '../templates/Store/Store';\nimport { DigitalTwinActions } from '../../redux/actions';\nimport { getOrDownloadDigitalTwins } from '../../utils/digitalTwins';\nimport { createDigitalTwin } from '../../services/api/digital-twin';\nconst dtUserId = 1;\nexport const NewDigitalTwin = () => {\n  useMountEffect(() => {\n    getOrDownloadDigitalTwins(digitalTwins).then(result => {\n      dispatchDigitalTwinsActions(DigitalTwinActions.updateDigitalTwins(result));\n    }).catch(e => {\n      console.error(e);\n    });\n  });\n  const {\n    data: digitalTwins,\n    dispatchAction: dispatchDigitalTwinsActions\n  } = useStore('digitalTwins');\n  const [redirectTo, setRedirectTo] = useState(\"\");\n  const [dtName, setDtName] = useState('');\n  let dtId = 1;\n\n  const redirectToList = () => setRedirectTo(routes.digitalTwinMonitoring);\n\n  const buildDigitalTwin = () => ({\n    dtName,\n    dtId,\n    dtUserId\n  });\n\n  const redirectToListAndUpdateLocal = () => {\n    dispatchDigitalTwinsActions(DigitalTwinActions.addDigitalTwin(buildDigitalTwin()));\n    redirectToList();\n  };\n\n  const createDigitalTwinAction = () => {\n    return new Promise((res, rej) => {\n      createDigitalTwin(dtName.trim()).then(result => {\n        dtId = result.extra.lastInsertedId;\n        res('Functionality created');\n      }).catch(e => rej(e.msg));\n    });\n  };\n\n  if (redirectTo !== \"\") return /*#__PURE__*/React.createElement(Redirect, {\n    to: redirectTo,\n    push: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 12\n    }\n  });\n  return /*#__PURE__*/React.createElement(Navigator, {\n    title: \"New Digital Twin\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(DigitalTwinForm, {\n    dtName: {\n      dtName,\n      setDtName\n    },\n    cancel: {\n      action: redirectToList,\n      label: 'Cancel'\n    },\n    confirmDialog: {\n      buttonTitle: 'Confirm',\n      title: 'Creating Digital Twin',\n      initialState: ConfirmActionStateLabel.executing,\n      action: createDigitalTwinAction,\n      onSuccess: redirectToListAndUpdateLocal,\n      success: {\n        label: '',\n        positiveLabel: 'Ok'\n      },\n      error: {\n        label: '',\n        positiveLabel: 'Ok'\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }\n  })));\n};","map":{"version":3,"sources":["/media/maria/96ae9a87-ebe3-48cb-a2c1-fae5fe76b9e7/maria/Marketplace-JurassicPark/backend/web/src/components/DigitalTwin/NewDigitalTwin.tsx"],"names":["React","useState","Navigator","Redirect","routes","ConfirmActionStateLabel","DigitalTwinForm","useMountEffect","useStore","DigitalTwinActions","getOrDownloadDigitalTwins","createDigitalTwin","dtUserId","NewDigitalTwin","digitalTwins","then","result","dispatchDigitalTwinsActions","updateDigitalTwins","catch","e","console","error","data","dispatchAction","redirectTo","setRedirectTo","dtName","setDtName","dtId","redirectToList","digitalTwinMonitoring","buildDigitalTwin","redirectToListAndUpdateLocal","addDigitalTwin","createDigitalTwinAction","Promise","res","rej","trim","extra","lastInsertedId","msg","action","label","buttonTitle","title","initialState","executing","onSuccess","success","positiveLabel"],"mappings":"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","sourcesContent":["import React, { useState } from 'react'\r\nimport { Navigator } from '../templates/Navigator/Navigator'\r\nimport { DigitalTwin } from '../../model/index'\r\nimport { Redirect } from 'react-router-dom'\r\nimport { routes } from '../../App'\r\nimport { ConfirmActionStateLabel } from '../templates/ConfirmAction/ConfirmAction'\r\nimport { RequestResponseState } from '../../services/api/api'\r\nimport { DigitalTwinForm} from './DigitalTwinForm'\r\nimport { useMountEffect } from '../../utils/main'\r\nimport { useStore } from '../templates/Store/Store'\r\nimport { DigitalTwinActions } from '../../redux/actions'\r\nimport { getOrDownloadDigitalTwins } from '../../utils/digitalTwins'\r\nimport { createDigitalTwin } from '../../services/api/digital-twin'\r\n\r\nconst dtUserId = 1\r\n\r\nexport const NewDigitalTwin = () => {\r\n\r\n  useMountEffect(() => {\r\n    \r\n    getOrDownloadDigitalTwins(digitalTwins)\r\n      .then((result: DigitalTwin[]) => {\r\n          dispatchDigitalTwinsActions(DigitalTwinActions.updateDigitalTwins(result))\r\n      })\r\n      .catch((e:RequestResponseState) => {\r\n          console.error(e)\r\n      })\r\n\r\n  })\r\n\r\n  const {data: digitalTwins, dispatchAction:dispatchDigitalTwinsActions} = useStore('digitalTwins')\r\n\r\n  const [redirectTo, setRedirectTo] : [string, Function] = useState(\"\")\r\n\r\n  const [dtName,setDtName] : [string,Function] = useState('')\r\n\r\n  let dtId = 1\r\n\r\n  const redirectToList = () => setRedirectTo(routes.digitalTwinMonitoring)\r\n\r\n  const buildDigitalTwin = () : DigitalTwin => ({\r\n    dtName, dtId, dtUserId\r\n  })\r\n\r\n  const redirectToListAndUpdateLocal = () => {\r\n    dispatchDigitalTwinsActions(DigitalTwinActions.addDigitalTwin(buildDigitalTwin()))\r\n    redirectToList()\r\n  } \r\n\r\n  const createDigitalTwinAction = () : Promise<string> => {\r\n    \r\n    return new Promise<string>((res:Function, rej:Function)  => {\r\n\r\n        createDigitalTwin(dtName.trim())\r\n\r\n            .then((result: RequestResponseState) => {\r\n            dtId= result.extra.lastInsertedId\r\n                res('Functionality created')\r\n            })\r\n\r\n            .catch((e:RequestResponseState) => rej(e.msg))\r\n\r\n    })\r\n  }\r\n  \r\n  if(redirectTo !== \"\") \r\n    return <Redirect to={redirectTo} push={true} />\r\n  \r\n  return (\r\n    <Navigator title=\"New Digital Twin\">\r\n      <>\r\n      <DigitalTwinForm\r\n        dtName={{dtName, setDtName}}\r\n        cancel={{action: redirectToList, label: 'Cancel'}}\r\n        confirmDialog={{\r\n          buttonTitle: 'Confirm',\r\n          title: 'Creating Digital Twin',\r\n          initialState: ConfirmActionStateLabel.executing,\r\n          action: createDigitalTwinAction,\r\n          onSuccess: redirectToListAndUpdateLocal,\r\n          success: {\r\n            label: '',\r\n            positiveLabel: 'Ok'\r\n          },\r\n          error: {\r\n            label: '',\r\n            positiveLabel: 'Ok'\r\n          },\r\n        }}\r\n      />\r\n      </>\r\n    </Navigator>\r\n  )\r\n}"]},"metadata":{},"sourceType":"module"}