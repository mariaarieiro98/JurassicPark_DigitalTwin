{"ast":null,"code":"var _jsxFileName = \"/media/maria/96ae9a87-ebe3-48cb-a2c1-fae5fe76b9e7/maria/Marketplace-JurassicPark/backend/web/src/components/DigitalTwin/SmartComponent.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React, { useEffect, useState, useCallback } from 'react';\nimport { useFunctionBlockStyles } from \"../FunctionBlocks/FunctionBlock/style\";\nimport { Grid, FormControl, InputLabel, Select, Button, MenuItem } from \"@material-ui/core\";\nimport { useMountEffect } from '../../utils/main';\nimport { getOrDownloadSmartComponents } from '../../utils/smartComponents';\nimport { useStore } from '../templates/Store/Store';\nimport { SmartComponentActions } from '../../redux/actions';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const SmartComponentList = /*#__PURE__*/React.memo(_c = _s(props => {\n  _s();\n\n  const {\n    smartComponents,\n    setSmartComponents,\n    onSmartComponentRemoval\n  } = props;\n  const classes = useFunctionBlockStyles();\n  const newSc = {\n    scId: -1,\n    scName: \"\",\n    scAddress: \"\",\n    scPort: -1\n  };\n  const [newSmartComponent, setNewSmartComponent] = useState(newSc);\n  const setSmartComponent = useCallback((smartComponent, index) => {\n    setSmartComponents(prevScs => {\n      const oldSmartComponent = prevScs[index];\n      const newSmartComponents = [...prevScs];\n      newSmartComponents[index] = smartComponent;\n      return newSmartComponents;\n    });\n  }, [setSmartComponents]);\n  const addSmartComponent = useCallback(scToAdd => {\n    setSmartComponents(prevSmartComponents => [...prevSmartComponents, scToAdd]);\n    setNewSmartComponent(newSc);\n  }, [setSmartComponents, newSc]);\n  const removeSmartComponent = useCallback(smartComponentToRemove => {\n    setSmartComponents(prevSmartComponents => prevSmartComponents.filter((smartComponent, index) => smartComponent !== smartComponentToRemove));\n    onSmartComponentRemoval(smartComponentToRemove);\n  }, [onSmartComponentRemoval, setSmartComponents]);\n  return /*#__PURE__*/_jsxDEV(Grid, {\n    container: true,\n    direction: \"column\",\n    children: [/*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      children: props.title\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      className: classes.box,\n      children: [smartComponents.map((smartComponent, index) => /*#__PURE__*/_jsxDEV(SmartComponentRow, {\n        index: index,\n        addRemoveSmartComponent: removeSmartComponent,\n        setSmartComponent: setSmartComponent,\n        smartComponent: smartComponent,\n        newSc: false\n      }, index, false, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 79\n      }, this)), /*#__PURE__*/_jsxDEV(SmartComponentRow, {\n        index: -1,\n        addRemoveSmartComponent: addSmartComponent,\n        setSmartComponent: setNewSmartComponent,\n        smartComponent: newSmartComponent,\n        newSc: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 59,\n    columnNumber: 5\n  }, this);\n}, \"nEPT5xElcQIY0XQYnP2j9DCOoCw=\", false, function () {\n  return [useFunctionBlockStyles];\n}));\n_c2 = SmartComponentList;\nconst SmartComponentRow = /*#__PURE__*/React.memo(_c3 = _s2(props => {\n  _s2();\n\n  const classes = useFunctionBlockStyles();\n  const [validName, setValidName] = useState(\"\");\n  const [fetching, setFetching] = useState(true);\n  const {\n    data: smartComponents,\n    dispatchAction: dispatchSmartComponentActions\n  } = useStore('smartComponents');\n\n  const updateSmartComponents = scs => dispatchSmartComponentActions(SmartComponentActions.updateSmartComponent(scs));\n\n  const [error, setError] = useState('');\n  const isValid = useCallback(() => props.smartComponent.scName !== '', [props.smartComponent]);\n\n  const action = () => {\n    if (!isValid() && props.newSc) setValidName(\"Mandatory\");else props.addRemoveSmartComponent(props.smartComponent);\n  };\n\n  const validate = useCallback(() => {\n    !isValid() ? setValidName(\"Mandatory\") : setValidName('');\n  }, [isValid]);\n  useEffect(() => {\n    if (!props.newSc) validate();\n  }, [props.smartComponent.scName, props.newSc, validate]);\n\n  const updateField = field => event => {\n    props.setSmartComponent({ ...props.smartComponent,\n      [field]: event.target.value\n    }, props.index);\n  }; // Recuperar diretamente da comunicação OPC-UA os smart_components disponíveis (SmartComponent)\n\n\n  useMountEffect(() => {\n    setTimeout(() => {\n      setFetching(true);\n      getOrDownloadSmartComponents(smartComponents).then(result => updateSmartComponents(result)).catch(e => setError(e.msg)).finally(() => setFetching(false));\n    }, 0);\n  });\n  return /*#__PURE__*/_jsxDEV(Grid, {\n    item: true,\n    xs: 12,\n    container: true,\n    direction: \"row\",\n    justify: \"space-between\",\n    alignItems: \"center\",\n    children: [props.order ? /*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      xs: 12,\n      children: props.order\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }, this) : null, /*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      xs: 8,\n      children: /*#__PURE__*/_jsxDEV(FormControl, {\n        fullWidth: true,\n        required: true,\n        children: [/*#__PURE__*/_jsxDEV(InputLabel, {\n          id: `smart-component-label-${props.smartComponent.scName}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Select, {\n          labelId: `smart-component-label-${props.smartComponent.scName}`,\n          value: props.smartComponent.scName,\n          onChange: updateField('scName'),\n          children: (smartComponents || []).map(smartComponent => {\n            return /*#__PURE__*/_jsxDEV(MenuItem, {\n              value: smartComponent.scName,\n              children: `${smartComponent.scAddress}, ${smartComponent.scName}, ${smartComponent.scPort} `\n            }, smartComponent.scId, false, {\n              fileName: _jsxFileName,\n              lineNumber: 144,\n              columnNumber: 77\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      xs: 4,\n      children: /*#__PURE__*/_jsxDEV(Button, {\n        className: classes.varEvButton,\n        size: \"small\",\n        variant: \"contained\",\n        onClick: action,\n        children: props.newSc ? '+' : 'x'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 129,\n    columnNumber: 5\n  }, this);\n}, \"luLnUB28zaZCTVZpdBdaWdamFfo=\", false, function () {\n  return [useFunctionBlockStyles, useStore, useMountEffect];\n}), (prevProps, nextProps) => prevProps.smartComponent === nextProps.smartComponent);\n_c4 = SmartComponentRow;\n\nvar _c, _c2, _c3, _c4;\n\n$RefreshReg$(_c, \"SmartComponentList$React.memo\");\n$RefreshReg$(_c2, \"SmartComponentList\");\n$RefreshReg$(_c3, \"SmartComponentRow$React.memo\");\n$RefreshReg$(_c4, \"SmartComponentRow\");","map":{"version":3,"sources":["/media/maria/96ae9a87-ebe3-48cb-a2c1-fae5fe76b9e7/maria/Marketplace-JurassicPark/backend/web/src/components/DigitalTwin/SmartComponent.tsx"],"names":["React","useEffect","useState","useCallback","useFunctionBlockStyles","Grid","FormControl","InputLabel","Select","Button","MenuItem","useMountEffect","getOrDownloadSmartComponents","useStore","SmartComponentActions","SmartComponentList","memo","props","smartComponents","setSmartComponents","onSmartComponentRemoval","classes","newSc","scId","scName","scAddress","scPort","newSmartComponent","setNewSmartComponent","setSmartComponent","smartComponent","index","prevScs","oldSmartComponent","newSmartComponents","addSmartComponent","scToAdd","prevSmartComponents","removeSmartComponent","smartComponentToRemove","filter","title","box","map","SmartComponentRow","validName","setValidName","fetching","setFetching","data","dispatchAction","dispatchSmartComponentActions","updateSmartComponents","scs","updateSmartComponent","error","setError","isValid","action","addRemoveSmartComponent","validate","updateField","field","event","target","value","setTimeout","then","result","catch","e","msg","finally","order","varEvButton","prevProps","nextProps"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useCallback } from 'react'\nimport { useFunctionBlockStyles } from \"../FunctionBlocks/FunctionBlock/style\"\nimport { SmartComponent } from \"../../model/index\"\nimport { Grid, FormControl, InputLabel, Select, Button, MenuItem } from \"@material-ui/core\"\nimport { useMountEffect } from '../../utils/main'\nimport { getOrDownloadSmartComponents } from '../../utils/smartComponents'\nimport { RequestResponseState } from '../../services/api/api'\nimport { useStore } from '../templates/Store/Store'\nimport { SmartComponentActions } from '../../redux/actions'\n\ninterface SmartComponentProps {\n  setSmartComponents: Function\n  smartComponents: SmartComponent[]\n  title: string\n  onSmartComponentRemoval: (smartComponent: SmartComponent) => void\n}\n\nexport const SmartComponentList = React.memo((props: SmartComponentProps) => {\n  \n  const {smartComponents,setSmartComponents,onSmartComponentRemoval} = props\n\n  const classes = useFunctionBlockStyles()\n\n  const newSc : SmartComponent = {\n    scId: -1,\n    scName: \"\",\n    scAddress: \"\",\n    scPort: -1,\n  }\n\n  const [newSmartComponent,setNewSmartComponent] : [SmartComponent,Function] = useState(newSc)\n\n  const setSmartComponent = useCallback((smartComponent: SmartComponent , index:number) => {\n\n    setSmartComponents((prevScs: SmartComponent[]) => {\n\n      const oldSmartComponent : SmartComponent = prevScs[index]\n      const newSmartComponents : SmartComponent[] = [...prevScs]\n      newSmartComponents[index] = smartComponent\n      return newSmartComponents\n\n    }) \n\n  },[setSmartComponents])\n\n  const addSmartComponent = useCallback((scToAdd: SmartComponent) => {\n    \n    setSmartComponents((prevSmartComponents: SmartComponent[]) =>[...prevSmartComponents, scToAdd])\n    setNewSmartComponent(newSc)\n\n  }, [setSmartComponents,newSc]) \n\n  const removeSmartComponent = useCallback((smartComponentToRemove:SmartComponent) => {\n    setSmartComponents((prevSmartComponents: SmartComponent[]) => prevSmartComponents.filter((smartComponent:SmartComponent,index:number) => smartComponent !== smartComponentToRemove))\n    onSmartComponentRemoval(smartComponentToRemove)\n  },[onSmartComponentRemoval,setSmartComponents]) \n\n  return (\n    <Grid container direction=\"column\">\n      <Grid item>{props.title}</Grid>\n      <Grid item className={classes.box}>\n        {smartComponents.map((smartComponent:SmartComponent, index:number) => <SmartComponentRow key={index} index={index} addRemoveSmartComponent={removeSmartComponent} setSmartComponent={setSmartComponent} smartComponent={smartComponent} newSc={false} />)}\n        <SmartComponentRow index={-1} addRemoveSmartComponent={addSmartComponent} setSmartComponent={setNewSmartComponent} smartComponent={newSmartComponent} newSc={true}  />\n      </Grid> \n    </Grid>\n  )\n})\n\ninterface SmartComponentRowProps {\n  index: number \n  addRemoveSmartComponent: (smartComponent: SmartComponent) => void\n  setSmartComponent:Function\n  smartComponent: SmartComponent\n  newSc: boolean\n  order?: number\n}\n\nconst SmartComponentRow = React.memo((props: SmartComponentRowProps) => {\n\n  const classes = useFunctionBlockStyles()\n\n  const [validName,setValidName] = useState(\"\")\n\n  const [fetching,setFetching] = useState(true)\n  const {data:smartComponents, dispatchAction:dispatchSmartComponentActions} = useStore('smartComponents')\n  const updateSmartComponents = (scs: SmartComponent[]) => dispatchSmartComponentActions(SmartComponentActions.updateSmartComponent(scs))\n  const [error,setError] = useState('')\n\n  const isValid = useCallback(() => props.smartComponent.scName !== '', [props.smartComponent])\n\n  const action = () => {\n\n    if(!isValid() && props.newSc) \n      setValidName(\"Mandatory\")\n    \n    else\n      props.addRemoveSmartComponent(props.smartComponent)\n    \n  }\n  const validate = useCallback(() => {\n    \n    !isValid() ? setValidName(\"Mandatory\") : setValidName('')\n\n  },[isValid]) \n\n  useEffect(() => {if(!props.newSc) validate()}, [props.smartComponent.scName, props.newSc, validate])\n\n  const updateField = (field:string) => (event:any) => {\n\n    props.setSmartComponent({...props.smartComponent, [field]: event.target.value},props.index)\n  \n  }\n\n    // Recuperar diretamente da comunicação OPC-UA os smart_components disponíveis (SmartComponent)\n    useMountEffect(() => {\n\n      setTimeout(() => {\n  \n      setFetching(true)\n      getOrDownloadSmartComponents(smartComponents)\n          .then((result: SmartComponent[]) => updateSmartComponents(result))\n          .catch((e:RequestResponseState) => setError(e.msg))\n          .finally(() => setFetching(false))\n      }, 0)\n    })\n\n\n  return (\n    <Grid item xs={12} container direction=\"row\" justify=\"space-between\" alignItems=\"center\">\n      { props.order ?\n      <Grid item xs={12}>\n          {props.order}\n      </Grid>\n      : null\n      }\n      <Grid item xs={8}>\n      <FormControl fullWidth required>\n          <InputLabel id={`smart-component-label-${props.smartComponent.scName}`}></InputLabel>\n            <Select\n              labelId={`smart-component-label-${props.smartComponent.scName}`}\n              value={props.smartComponent.scName}\n              onChange={updateField('scName')}\n            >\n              {(smartComponents || []).map((smartComponent: any) => {return <MenuItem key={smartComponent.scId} value={smartComponent.scName}>{`${smartComponent.scAddress}, ${smartComponent.scName}, ${smartComponent.scPort} `}</MenuItem>})}\n            </Select>\n      </FormControl>\n      </Grid>\n      <Grid item xs={4}>\n      <Button \n          className={classes.varEvButton} \n          size=\"small\" \n          variant=\"contained\"\n          onClick={action}\n        >\n        {props.newSc ? '+' : 'x' }</Button>\n      </Grid>\n    </Grid>\n  )\n  }\n ,(prevProps:SmartComponentRowProps, nextProps: SmartComponentRowProps) => prevProps.smartComponent === nextProps.smartComponent\n)\n"]},"metadata":{},"sourceType":"module"}